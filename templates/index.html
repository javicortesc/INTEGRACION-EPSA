<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Extraportuario - EPSA</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <img src="https://www.puertosanantonio.com/themes/custom/ Antônio/logo.svg" alt="Puerto San Antonio Logo" id="logo">
        <h1>Especificación técnica para la integración Extraportuarios – EPSA</h1>
        <p id="app-version">{{ app_version }}</p>
    </header>

    <main>
        <div class="container">
            <h2>Panel de Control Extraportuario</h2>

            <div class="form-section">
                <h3>1. Avisar Camión Listo para Salir</h3>
                <form id="avisoCamionForm">
                    <div>
                        <label for="licencePlate">Patente Camión:</label>
                        <input type="text" id="licencePlate" name="licencePlate" value="AABB11" required>
                    </div>
                    <div>
                        <label for="containerId">ID Contenedor:</label>
                        <input type="text" id="containerId" name="containerId" value="TEST1234567" required>
                    </div>
                    <div>
                        <label for="isocode">ISO Code Contenedor (4 car.):</label>
                        <input type="text" id="isocode" name="isocode" value="22G1" maxlength="4" required>
                    </div>
                    <button type="submit">Enviar Aviso a EPSA</button>
                </form>
            </div>

            <div class="status-section">
                <h3>2. Estado del Trámite</h3>
                <div id="statusMessages">
                    <p>Esperando acciones...</p>
                </div>
                <div id="currentTruckInfo">
                    <h4>Información del Camión Actual:</h4>
                    <p><strong>ID Ingreso:</strong> <span id="currentIngresoId">-</span></p>
                    <p><strong>Patente:</strong> <span id="currentLicencePlate">-</span></p>
                    <p><strong>Contenedor:</strong> <span id="currentContainerId">-</span></p>
                    <p><strong>Estado EPSA:</strong> <span id="currentEpsaStatus">-</span></p>
                    <p><strong>Mensaje EPSA:</strong> <span id="currentEpsaMessage">-</span></p>
                </div>
            </div>

            <div class="actions-section">
                <h3>3. Acciones Post-Autorización</h3>
                <button id="confirmarSalidaBtn" disabled>Confirmar Salida del Camión</button>
                <button id="eliminarAvisoBtn" disabled>Eliminar Aviso (Opcional)</button>
            </div>
             <div class="log-section">
                <h3>Log de Eventos (Consola del Navegador y Flask)</h3>
                <p>Revisar la consola del navegador (F12) y la terminal donde corre Flask para ver los logs detallados de las interacciones.</p>
            </div>
        </div>
    </main>

    <footer>
        <p>Simulador basado en "Especificación técnica para la integración Extraportuarios – EPSA Mayo 2025 – Versión 2"</p>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>